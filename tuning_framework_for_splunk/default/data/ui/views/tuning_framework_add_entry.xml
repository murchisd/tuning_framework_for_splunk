        <dashboard version="2" theme="dark" hiddenElements="{&quot;hideEdit&quot;:false,&quot;hideOpenInSearch&quot;:false,&quot;hideExport&quot;:false}">
            <label>Add Entry</label>
            <description>Tool for analysts to add entries from Tuning Framework.</description>
            <definition><![CDATA[{"dataSources":{"ds_search_names":{"type":"ds.search","options":{"done":{"unset":"input_rule_names"},"queryParameters":{"earliest":"-24h@h","latest":"now"},"query":"| rest splunk_server=local count=0 /servicesNS/-/SplunkEnterpriseSecuritySuite/saved/searches \n| where match('action.correlationsearch.enabled', \"1|[Tt]|[Tt][Rr][Uu][Ee]\") \n| where disabled=0 \n| table title "},"name":"search_names"},"ds_LEiTNE3t":{"type":"ds.search","options":{"queryParameters":{"earliest":"-24h@h","latest":"now"},"query":"| makeresults\r\n| eval lookup=\"$tuning_lookup$\", max_time=180, time_unit=\"d\", time_period=if(max_time<$entry_lifetime$,max_time,$entry_lifetime$)\r\n| eval rules=\"$rule_names$\", operator=\"$operator$\",lifetime=time_period.time_unit, field=\"$field$\", value=\"$value$\", notes=\"$notes$\", ignore_warnings=\"$ignore_warnings$\", risk_score=\"$risk_score$\"\r\n| eval tmp_field=split(field,\"|\"), tmp_value=split(value,\"|\"), tmp_field_count=mvcount(tmp_field), tmp_value_count=mvcount(tmp_value)\r\n| eval validation=if(operator=\"and\" AND tmp_field_count!=tmp_value_count,\"Error: Logic Operator \\\"AND\\\" entries must have same number of pipe delimited entries in \\\"field\\\" input as \\\"value\\\" input\",if(operator=\"or\" AND match(value,\"\\|\") AND ignore_warnings=\"false\",\"Warning: \\\"value\\\" input contains a pipe for Logic Operator \\\"OR\\\" - Multiple values will be suppressed using pipe delimiter - Verify this is desired behavior - select ignore warnings to suppress this message\", if(operator=\"or\" AND match(value,\"\\x5c\") AND ignore_warnings=\"false\",\"Warning: \\\"value\\\" input contains a backwards slash - If this is to escape a special character must use two slashes (\\\\\\\\\\\"); a literal slash will require four slashes (\\\\\\\\\\\\\\\\) - Properly escaped slashes will show as a single slash in Tuning Entry Preview - select ignore warnings to suppress this message\", if(max_time<$entry_lifetime$ AND ignore_warnings=\"false\",\"Warning: lifetime greater than max allowable time - lifetime will be updated to \".max_time.time_unit.\" - select ignore warnings to suppress this message\",if(match(value,\"\\*\"),\"Error: Value contains \\\"*\\\" which will be treated as wildcard. Please reach out to Admin to confirm impact of this suppression.\",\"ok\")))))\r\n| rename _time as created_time\r\n | rex mode=sed field=rules \"s/,/|/g\"\r\n | table validation created_time field value rules operator lifetime notes risk_score"},"name":"tuning_output_lookup_base"},"ds_TphEqKUl":{"type":"ds.chain","options":{"extend":"ds_LEiTNE3t","query":"| search validation=\"ok\"\n|  fields - validation\n| |  eval value=lower(value)\n|outputlookup $tuning_lookup$ append=t\n| eval lookup=\"$tuning_lookup$\"\n| eval id=sha1(created_time.\"|\".operator.\"|\".field.\"|\".value) \n| stats count by field value lookup id\n```If unsuccessful should throw error and never get here```\n| join [| rest /services/authentication/current-context splunk_server=local | table username]\n| eval result=if(count>0,username.\" successfully added \".field.\" \".value.\" to \".lookup,\"Error: \".username.\"failed to add \".field.\" \".value.\" to \".lookup), action=\"add_entry\"\n| table username action result id\n| collect index=_audit source=\"tuning_framework\" "},"name":"tuning_output_lookup"}},"inputs":{"input_rule_names":{"options":{"token":"rule_names"},"encoding":{"label":"primary[0]","value":"primary[0]"},"dataSources":{"primary":"ds_search_names"},"title":"Correlation Searches","type":"input.multiselect"},"input_yP8LDMYZ":{"options":{"items":[{"label":"OR","value":"or"},{"label":"AND","value":"and"}],"token":"operator"},"title":"Logic Operator","type":"input.dropdown"},"input_kH6kF9sq":{"options":{"defaultValue":60,"token":"entry_lifetime","step":1,"max":180,"min":1},"title":"Lifetime (Days)","type":"input.number"},"input_g8LJsOyV":{"options":{"token":"field"},"title":"Tuning Fields (Pipe Delimited)","type":"input.text"},"input_jEwoFgS1":{"options":{"token":"value"},"title":"Tuning Values (Pipe Delimited)","type":"input.text"},"input_OuvV8ywB":{"options":{"token":"notes"},"title":"Notes","type":"input.text"},"input_O2Rq9gSN":{"options":{"items":[{"label":"Yes","value":"true"},{"label":"No","value":"false"}],"defaultValue":"false","token":"ignore_warnings"},"title":"Ignore Warnings","type":"input.dropdown"},"input_CcomITbL":{"options":{"token":"risk_score","max":100,"step":1,"min":0,"defaultValue":10},"title":"Risk Score (RBA Only)","type":"input.number"},"input_wDfl2Rf0":{"options":{"items":[{"label":"Risk Score Override","value":"rba_risk_score_override_lookup"},{"label":"Suppression","value":"time_based_suppression_lookup"}],"token":"tuning_lookup","selectFirstSearchResult":true},"title":"Tuning Mode","type":"input.dropdown"}},"layout":{"type":"absolute","options":{"submitButton":true,"display":"auto-scale","width":1910},"structure":[{"item":"viz_7sjmKxHw","type":"block","position":{"x":10,"y":360,"w":1890,"h":180}},{"item":"viz_X55ZITMf","type":"block","position":{"x":10,"y":0,"w":1850,"h":50}},{"item":"viz_JM8Ixrke","type":"block","position":{"x":10,"y":540,"w":1890,"h":180}},{"item":"viz_UORzUwT1","type":"block","position":{"x":10,"y":30,"w":1860,"h":320}}],"globalInputs":["input_wDfl2Rf0","input_rule_names","input_g8LJsOyV","input_jEwoFgS1","input_kH6kF9sq","input_yP8LDMYZ","input_CcomITbL","input_OuvV8ywB","input_O2Rq9gSN"]},"description":"Tool for analysts to add entries from Tuning Framework.","title":"Add Entry","defaults":{"dataSources":{"ds.search":{"options":{"queryParameters":{}}}}},"visualizations":{"viz_7sjmKxHw":{"type":"splunk.table","options":{"count":1,"wrap":true,"headerVisibility":"fixed"},"dataSources":{"primary":"ds_LEiTNE3t"},"title":"Tuning Entry Preview"},"viz_JM8Ixrke":{"type":"splunk.table","options":{"count":1,"wrap":true,"headerVisibility":"fixed"},"dataSources":{"primary":"ds_TphEqKUl"},"title":"Tuning Output Lookup Action"},"viz_X55ZITMf":{"options":{"markdown":"# Usage"},"type":"splunk.markdown","context":{}},"viz_UORzUwT1":{"options":{"markdown":"### Use the above inputs to specify the details for the tuning entry. The behavior of the tuning entry depends on both the Tuning Mode and Logic Operator. Tuning Mode allows analyst to either suppress or set the risk_score field for matching events. Logic Operator can be an AND or an OR:  \n\n- **OR - This type will match when any of the specified fields equal any of the specified values (src=10.0.0.1 OR src_ip=10.0.0.1) - Multiple fields can be specified with any number of values**\n- **AND - This type will match only when all specified fields and values are equal (dest=10.0.0.1 AND dest_port=445) - The number of fields specified must match the number of values**\n\n## Input Descriptions\n\n- **Correlation Searches - Multi-Select box with all enabled correlation searches - select the rules the suppression entry should apply to**\n- **Tuning Fields - Text box with pipe delimited fields to match against - <field1>|<field2>|...**\n- **Tuning Values - Text box with value(s) to match against (pipe delimited) -  <value1>|<value2>**\n- **Lifetime - Length in days that entry should remain on tuning list - Range 1-180 days** \n- **Logic Operator - Type of operator used to join multiple field and value combinations - AND or OR**\n- **Risk Score (RBA Only) - Value to set risk_score to when there is a match - This is only applied when Tuning Mode is set to Risk Score Override**\n- **Notes - Text Box to enter notes about entry**\n- **Ignore Warnings - Dropdown Boolean to ignore validation warnings when adding entry to tuning list**"},"type":"splunk.markdown"}}}]]></definition>
            <assets><![CDATA[{}]]></assets>
        </dashboard>
